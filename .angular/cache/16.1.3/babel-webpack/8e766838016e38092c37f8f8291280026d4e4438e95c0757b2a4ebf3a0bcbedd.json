{"ast":null,"code":"import { Client } from \"@stomp/stompjs\";\nimport * as i0 from \"@angular/core\";\nexport class WebSocketService {\n  constructor() {\n    this.path = 'http://localhost:8080/websocket';\n    this.stompClient = new Client({\n      brokerURL: this.path,\n      debug: str => {\n        console.log(str);\n      }\n    });\n  }\n  subscribe(formId, callback) {\n    const connected = this.stompClient.connected;\n    if (connected) {\n      return this.subscribeToForm(formId, callback);\n    }\n    return this.stompClient.connect({}, () => {\n      this.subscribeToForm(formId, callback);\n    });\n  }\n  subscribeToForm(formId, callback) {\n    return this.stompClient.subscribe(this.getDestination(formId), message => {\n      console.log('Received message:', message.body);\n    });\n  }\n  getDestination(formId) {\n    return '/response/answered_forms/queue/' + formId;\n  }\n}\nWebSocketService.ɵfac = function WebSocketService_Factory(t) {\n  return new (t || WebSocketService)();\n};\nWebSocketService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: WebSocketService,\n  factory: WebSocketService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["Client","WebSocketService","constructor","path","stompClient","brokerURL","debug","str","console","log","subscribe","formId","callback","connected","subscribeToForm","connect","getDestination","message","body","factory","ɵfac","providedIn"],"sources":["C:\\Важное\\6 семестр =)\\Практыка\\Проект\\questionnaire\\angular-questionnaire\\src\\app\\service\\web-socket.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport * as SockJS from \"sockjs-client\"\nimport Stomp from \"@stomp/ng2-stompjs\"\nimport {Subscription} from \"rxjs\";\nimport {Client} from \"@stomp/stompjs\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WebSocketService {\n  private path = 'http://localhost:8080/websocket';\n\n  stompClient = new Client({\n    brokerURL: this.path,\n    debug: (str) => {\n      console.log(str);\n    },\n  });\n\n  subscribe(formId: bigint, callback: any): Subscription {\n    const connected: boolean = this.stompClient.connected;\n    if (connected) {\n      return this.subscribeToForm(formId, callback);\n    }\n\n    return this.stompClient.connect({}, (): any => {\n      this.subscribeToForm(formId, callback);\n    });\n  }\n\n  private subscribeToForm(formId: bigint, callback: any): StompSubscription {\n    return this.stompClient.subscribe(this.getDestination(formId), (message) => {\n      console.log('Received message:', message.body);\n    });\n  }\n\n  private getDestination(formId: bigint): string {\n    return '/response/answered_forms/queue/' + formId;\n  }\n}\n"],"mappings":"AAIA,SAAQA,MAAM,QAAO,gBAAgB;;AAKrC,OAAM,MAAOC,gBAAgB;EAH7BC,YAAA;IAIU,KAAAC,IAAI,GAAG,iCAAiC;IAEhD,KAAAC,WAAW,GAAG,IAAIJ,MAAM,CAAC;MACvBK,SAAS,EAAE,IAAI,CAACF,IAAI;MACpBG,KAAK,EAAGC,GAAG,IAAI;QACbC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;MAClB;KACD,CAAC;;EAEFG,SAASA,CAACC,MAAc,EAAEC,QAAa;IACrC,MAAMC,SAAS,GAAY,IAAI,CAACT,WAAW,CAACS,SAAS;IACrD,IAAIA,SAAS,EAAE;MACb,OAAO,IAAI,CAACC,eAAe,CAACH,MAAM,EAAEC,QAAQ,CAAC;;IAG/C,OAAO,IAAI,CAACR,WAAW,CAACW,OAAO,CAAC,EAAE,EAAE,MAAU;MAC5C,IAAI,CAACD,eAAe,CAACH,MAAM,EAAEC,QAAQ,CAAC;IACxC,CAAC,CAAC;EACJ;EAEQE,eAAeA,CAACH,MAAc,EAAEC,QAAa;IACnD,OAAO,IAAI,CAACR,WAAW,CAACM,SAAS,CAAC,IAAI,CAACM,cAAc,CAACL,MAAM,CAAC,EAAGM,OAAO,IAAI;MACzET,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEQ,OAAO,CAACC,IAAI,CAAC;IAChD,CAAC,CAAC;EACJ;EAEQF,cAAcA,CAACL,MAAc;IACnC,OAAO,iCAAiC,GAAGA,MAAM;EACnD;;AA7BWV,gBAAgB,C;mBAAhBA,gBAAgB;AAAA;AAAhBA,gBAAgB,C;SAAhBA,gBAAgB;EAAAkB,OAAA,EAAhBlB,gBAAgB,CAAAmB,IAAA;EAAAC,UAAA,EAFf;AAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}