{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { FieldOption } from \"../../entity/FieldOption\";\nimport { FormArray, FormControl, FormGroup, Validators } from \"@angular/forms\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nfunction OptionListComponent_div_0_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"input\", 6);\n    i0.ɵɵelementStart(2, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function OptionListComponent_div_0_div_3_Template_button_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const i_r4 = restoredCtx.index;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.removeFieldOption(i_r4));\n    });\n    i0.ɵɵtext(3, \"Remove\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const i_r4 = ctx.index;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"placeholder\", \"\\u0412\\u0430\\u0440\\u0438\\u0430\\u043D\\u0442 \", i_r4 + 1, \"\");\n  }\n}\nfunction OptionListComponent_div_0_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 8);\n  }\n  if (rf & 2) {\n    const i_r8 = ctx.index;\n    i0.ɵɵpropertyInterpolate(\"formGroupName\", i_r8);\n  }\n}\nfunction OptionListComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 1)(2, \"form\", 2);\n    i0.ɵɵtemplate(3, OptionListComponent_div_0_div_3_Template, 4, 1, \"div\", 3);\n    i0.ɵɵtemplate(4, OptionListComponent_div_0_div_4_Template, 1, 1, \"div\", 4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function OptionListComponent_div_0_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.addFieldOption());\n    });\n    i0.ɵɵtext(6, \"Add Option\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.fieldOptionsForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.getOptionsFormArray().controls);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.fieldOptionsForm.get(\"options\")[\"controls\"]);\n  }\n}\nexport class OptionListComponent {\n  constructor() {\n    this.fieldOptions = [];\n    this.visible = false;\n    this.fieldOptionsChange = new EventEmitter();\n    this.fieldOptionsForm = new FormGroup({\n      options: new FormArray([new FormGroup({\n        text: new FormControl('', [Validators.required, Validators.maxLength(200)])\n      })])\n    });\n  }\n  ngOnInit() {\n    this.populateFieldOptionsForm();\n  }\n  getOptionsFormArray() {\n    return this.fieldOptionsForm.get('options');\n  }\n  populateFieldOptionsForm() {\n    const optionsArray = this.getOptionsFormArray();\n    //optionsArray.clear();\n    for (let i = 0; i < this.fieldOptions.length; i++) {\n      this.addFieldOption(this.fieldOptions[i].text);\n    }\n  }\n  addFieldOption(value = '') {\n    const optionsArray = this.getOptionsFormArray();\n    optionsArray.push(new FormGroup({\n      text: new FormControl(value, [Validators.required, Validators.maxLength(200)])\n    }));\n    this.fieldOptions.push(new FieldOption(null, ''));\n    this.updateTextInFieldOptions();\n  }\n  removeFieldOption(indexToRemove) {\n    const optionsArray = this.getOptionsFormArray();\n    optionsArray.removeAt(indexToRemove);\n    this.fieldOptions = this.fieldOptions.filter((_, index) => index != indexToRemove);\n    this.updateTextInFieldOptions();\n  }\n  updateTextInFieldOptions() {\n    const optionsArray = this.getOptionsFormArray();\n    for (let i = 0; i < this.fieldOptions.length; i++) {\n      /*let text = optionsArray[i].getFormGroup().values.text;*/\n      let text = optionsArray.controls[i].getRawValue().text;\n      this.fieldOptions[i].text = text;\n      this.fieldOptions[i].shownName = text;\n    }\n    this.fieldOptionsChange.emit(this.fieldOptions);\n    console.log('fieldOptions:');\n    this.fieldOptions.forEach(option => console.log(option.text + ', ' + option.id));\n  }\n}\nOptionListComponent.ɵfac = function OptionListComponent_Factory(t) {\n  return new (t || OptionListComponent)();\n};\nOptionListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OptionListComponent,\n  selectors: [[\"app-option-list\"]],\n  inputs: {\n    fieldOptions: \"fieldOptions\",\n    visible: \"visible\"\n  },\n  outputs: {\n    fieldOptionsChange: \"fieldOptionsChange\"\n  },\n  decls: 1,\n  vars: 1,\n  consts: [[4, \"ngIf\"], [1, \"options-container\"], [3, \"formGroup\"], [4, \"ngFor\", \"ngForOf\"], [3, \"formGroupName\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"type\", \"text\", \"formControlName\", \"text\", 1, \"form-control\", 3, \"placeholder\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [3, \"formGroupName\"]],\n  template: function OptionListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, OptionListComponent_div_0_Template, 7, 3, \"div\", 0);\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.visible);\n    }\n  },\n  dependencies: [i1.NgForOf, i1.NgIf, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName, i2.FormGroupName],\n  styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["EventEmitter","FieldOption","FormArray","FormControl","FormGroup","Validators","i0","ɵɵelementStart","ɵɵelement","ɵɵlistener","OptionListComponent_div_0_div_3_Template_button_click_2_listener","restoredCtx","ɵɵrestoreView","_r6","i_r4","index","ctx_r5","ɵɵnextContext","ɵɵresetView","removeFieldOption","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵpropertyInterpolate1","ɵɵpropertyInterpolate","i_r8","ɵɵtemplate","OptionListComponent_div_0_div_3_Template","OptionListComponent_div_0_div_4_Template","OptionListComponent_div_0_Template_button_click_5_listener","_r10","ctx_r9","addFieldOption","ɵɵproperty","ctx_r0","fieldOptionsForm","getOptionsFormArray","controls","get","OptionListComponent","constructor","fieldOptions","visible","fieldOptionsChange","options","text","required","maxLength","ngOnInit","populateFieldOptionsForm","optionsArray","i","length","value","push","updateTextInFieldOptions","indexToRemove","removeAt","filter","_","getRawValue","shownName","emit","console","log","forEach","option","id","selectors","inputs","outputs","decls","vars","consts","template","OptionListComponent_Template","rf","ctx","OptionListComponent_div_0_Template"],"sources":["C:\\Важное\\6 семестр =)\\Практыка\\Проект\\questionnaire\\angular-questionnaire\\src\\app\\components\\option-list\\option-list.component.ts","C:\\Важное\\6 семестр =)\\Практыка\\Проект\\questionnaire\\angular-questionnaire\\src\\app\\components\\option-list\\option-list.component.html"],"sourcesContent":["import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\nimport {FieldOption} from \"../../entity/FieldOption\";\nimport {FormArray, FormControl, FormGroup, Validators} from \"@angular/forms\";\n\n@Component({\n  selector: 'app-option-list',\n  templateUrl: './option-list.component.html',\n  styleUrls: ['./option-list.component.css']\n})\nexport class OptionListComponent implements OnInit {\n  @Input() fieldOptions: FieldOption[] = [];\n  @Input() visible: boolean = false;\n\n  @Output() fieldOptionsChange = new EventEmitter<FieldOption[]>();\n\n  fieldOptionsForm: FormGroup;\n\n  constructor() {\n    this.fieldOptionsForm = new FormGroup({\n      options: new FormArray([\n        new FormGroup({\n          text: new FormControl<string>('', [\n            Validators.required,\n            Validators.maxLength(200)\n          ])\n        })\n      ])\n    });\n  }\n\n  ngOnInit() {\n    this.populateFieldOptionsForm();\n  }\n\n  getOptionsFormArray(): FormArray {\n    return this.fieldOptionsForm.get('options') as FormArray;\n  }\n\n  private populateFieldOptionsForm() {\n    const optionsArray = this.getOptionsFormArray();\n    //optionsArray.clear();\n\n    for (let i = 0; i < this.fieldOptions.length; i++) {\n      this.addFieldOption(this.fieldOptions[i].text);\n    }\n  }\n\n  addFieldOption(value: string = '') {\n    const optionsArray = this.getOptionsFormArray();\n    optionsArray.push(\n      new FormGroup({\n        text: new FormControl<string>(value, [\n          Validators.required,\n          Validators.maxLength(200)\n        ])\n      })\n    );\n\n    this.fieldOptions.push(new FieldOption(null, ''));\n    this.updateTextInFieldOptions();\n  }\n\n  removeFieldOption(indexToRemove: number) {\n    const optionsArray = this.getOptionsFormArray();\n    optionsArray.removeAt(indexToRemove);\n\n    this.fieldOptions = this.fieldOptions.filter((_, index) => index != indexToRemove);\n    this.updateTextInFieldOptions();\n  }\n\n  updateTextInFieldOptions() {\n    const optionsArray = this.getOptionsFormArray();\n\n    for (let i = 0; i < this.fieldOptions.length; i++) {\n      /*let text = optionsArray[i].getFormGroup().values.text;*/\n      let text = optionsArray.controls[i].getRawValue().text;\n\n      this.fieldOptions[i].text = text;\n      this.fieldOptions[i].shownName = text;\n    }\n\n    this.fieldOptionsChange.emit(this.fieldOptions);\n\n    console.log('fieldOptions:');\n    this.fieldOptions.forEach(option => console.log(option.text + ', ' + option.id));\n  }\n}\n","<div *ngIf=\"visible\">\n  <div class=\"options-container\">\n    <form [formGroup]=\"fieldOptionsForm\">\n      <div *ngFor=\"let optionCtrl of getOptionsFormArray().controls; let i = index\">\n        <input type=\"text\" formControlName=\"text\" class=\"form-control\" placeholder=\"Вариант {{i + 1}}\">\n        <button type=\"button\" class=\"btn btn-danger\" (click)=\"removeFieldOption(i)\">Remove</button>\n      </div>\n\n      <div *ngFor=\"let child of fieldOptionsForm.get('options')['controls']; let i = index\"\n           formGroupName=\"{{i}}\"\n      >\n\n      </div>\n    </form>\n  </div>\n  <button type=\"button\" class=\"btn btn-primary\" (click)=\"addFieldOption()\">Add Option</button>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}