{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { FieldOption } from \"../../entity/FieldOption\";\nimport { FormArray, FormControl, FormGroup, Validators } from \"@angular/forms\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"../../little-components/field-name/field-name.component\";\nfunction OptionListComponent_div_0_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"div\", 9)(2, \"div\", 10)(3, \"input\", 11);\n    i0.ɵɵlistener(\"change\", function OptionListComponent_div_0_div_7_Template_input_change_3_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r4.updateTextInFieldOptions());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 12)(5, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function OptionListComponent_div_0_div_7_Template_button_click_5_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const i_r3 = restoredCtx.index;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.removeFieldOption(i_r3));\n    });\n    i0.ɵɵtext(6, \"\\u2715\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const i_r3 = ctx.index;\n    i0.ɵɵpropertyInterpolate(\"formGroupName\", i_r3);\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate1(\"placeholder\", \"\\u0412\\u0430\\u0440\\u0438\\u0430\\u043D\\u0442 \", i_r3 + 1, \"\");\n  }\n}\nfunction OptionListComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"br\");\n    i0.ɵɵelementStart(2, \"p\", 1);\n    i0.ɵɵelement(3, \"app-field-name\", 2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 3)(5, \"form\", 4)(6, \"div\", 5);\n    i0.ɵɵtemplate(7, OptionListComponent_div_0_div_7_Template, 7, 2, \"div\", 6);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(8, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function OptionListComponent_div_0_Template_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.addFieldOption());\n    });\n    i0.ɵɵtext(9, \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"required\", true);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.fieldOptionsForm);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.fieldOptionsForm.get(\"options\")[\"controls\"]);\n  }\n}\nexport class OptionListComponent {\n  constructor() {\n    this.fieldOptions = [];\n    this.visible = false;\n    this.fieldOptionsChange = new EventEmitter();\n    this.fieldOptionsForm = new FormGroup({\n      options: new FormArray([new FormGroup({\n        text: new FormControl('', [Validators.required, Validators.maxLength(200)])\n      })])\n    });\n  }\n  ngOnInit() {\n    this.populateFieldOptionsForm();\n  }\n  getOptionsFormArray() {\n    return this.fieldOptionsForm.get('options');\n  }\n  populateFieldOptionsForm() {\n    const optionsArray = this.getOptionsFormArray();\n    optionsArray.clear();\n    for (let i = 0; i < this.fieldOptions.length; i++) {\n      let value = this.fieldOptions[i].text;\n      optionsArray.push(new FormGroup({\n        text: new FormControl(value, [Validators.required, Validators.maxLength(200)])\n      }));\n    }\n  }\n  addFieldOption() {\n    const optionsArray = this.getOptionsFormArray();\n    optionsArray.push(new FormGroup({\n      text: new FormControl('', [Validators.required, Validators.maxLength(200)])\n    }));\n    this.fieldOptions.push(new FieldOption(null, ''));\n    this.fieldOptionsChange.emit(this.fieldOptions);\n  }\n  removeFieldOption(indexToRemove) {\n    const optionsArray = this.getOptionsFormArray();\n    optionsArray.removeAt(indexToRemove);\n    this.fieldOptions = this.fieldOptions.filter((_, index) => index != indexToRemove);\n    this.fieldOptionsChange.emit(this.fieldOptions);\n  }\n  updateTextInFieldOptions() {\n    const optionsArray = this.getOptionsFormArray();\n    for (let i = 0; i < this.fieldOptions.length; i++) {\n      let text = optionsArray.controls[i].getRawValue().text;\n      this.fieldOptions[i].text = text;\n      this.fieldOptions[i].shownName = text;\n    }\n    this.fieldOptionsChange.emit(this.fieldOptions);\n  }\n}\nOptionListComponent.ɵfac = function OptionListComponent_Factory(t) {\n  return new (t || OptionListComponent)();\n};\nOptionListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OptionListComponent,\n  selectors: [[\"app-option-list\"]],\n  inputs: {\n    fieldOptions: \"fieldOptions\",\n    visible: \"visible\"\n  },\n  outputs: {\n    fieldOptionsChange: \"fieldOptionsChange\"\n  },\n  decls: 1,\n  vars: 1,\n  consts: [[4, \"ngIf\"], [1, \"mt-0\", \"mb-0\"], [\"fieldName\", \"\\u0412\\u0430\\u0440\\u0438\\u0430\\u043D\\u0442\\u044B \\u043E\\u0442\\u0432\\u0435\\u0442\\u0430\", 3, \"required\"], [1, \"options-container\"], [3, \"formGroup\"], [\"formArrayName\", \"options\"], [3, \"formGroupName\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", 1, \"btn\", \"btn-dark\", \"mt-2\", \"text-white\", \"text-xl\", \"fw-semibold\", 3, \"click\"], [3, \"formGroupName\"], [1, \"row\", \"mt-1\"], [1, \"col\"], [\"type\", \"text\", \"formControlName\", \"text\", 1, \"form-control\", 3, \"placeholder\", \"change\"], [1, \"col-auto\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", \"text-white\", \"text-xl\", \"fw-bolder\", 3, \"click\"]],\n  template: function OptionListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, OptionListComponent_div_0_Template, 10, 3, \"div\", 0);\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.visible);\n    }\n  },\n  dependencies: [i1.NgForOf, i1.NgIf, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName, i2.FormGroupName, i2.FormArrayName, i3.FieldNameComponent],\n  styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["EventEmitter","FieldOption","FormArray","FormControl","FormGroup","Validators","i0","ɵɵelementStart","ɵɵlistener","OptionListComponent_div_0_div_7_Template_input_change_3_listener","ɵɵrestoreView","_r5","ctx_r4","ɵɵnextContext","ɵɵresetView","updateTextInFieldOptions","ɵɵelementEnd","OptionListComponent_div_0_div_7_Template_button_click_5_listener","restoredCtx","i_r3","index","ctx_r6","removeFieldOption","ɵɵtext","ɵɵpropertyInterpolate","ɵɵadvance","ɵɵpropertyInterpolate1","ɵɵelement","ɵɵtemplate","OptionListComponent_div_0_div_7_Template","OptionListComponent_div_0_Template_button_click_8_listener","_r8","ctx_r7","addFieldOption","ɵɵproperty","ctx_r0","fieldOptionsForm","get","OptionListComponent","constructor","fieldOptions","visible","fieldOptionsChange","options","text","required","maxLength","ngOnInit","populateFieldOptionsForm","getOptionsFormArray","optionsArray","clear","i","length","value","push","emit","indexToRemove","removeAt","filter","_","controls","getRawValue","shownName","selectors","inputs","outputs","decls","vars","consts","template","OptionListComponent_Template","rf","ctx","OptionListComponent_div_0_Template"],"sources":["C:\\Важное\\6 семестр =)\\Практыка\\Проект\\questionnaire\\angular-questionnaire\\src\\app\\components\\option-list\\option-list.component.ts","C:\\Важное\\6 семестр =)\\Практыка\\Проект\\questionnaire\\angular-questionnaire\\src\\app\\components\\option-list\\option-list.component.html"],"sourcesContent":["import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\r\nimport {FieldOption} from \"../../entity/FieldOption\";\r\nimport {FormArray, FormControl, FormGroup, Validators} from \"@angular/forms\";\r\n\r\n@Component({\r\n  selector: 'app-option-list',\r\n  templateUrl: './option-list.component.html',\r\n  styleUrls: ['./option-list.component.css']\r\n})\r\nexport class OptionListComponent implements OnInit {\r\n  @Input() fieldOptions: FieldOption[] = [];\r\n  @Input() visible: boolean = false;\r\n\r\n  @Output() fieldOptionsChange = new EventEmitter<FieldOption[]>();\r\n\r\n  fieldOptionsForm: FormGroup;\r\n\r\n  constructor() {\r\n    this.fieldOptionsForm = new FormGroup({\r\n      options: new FormArray([\r\n        new FormGroup({\r\n          text: new FormControl<string>('', [\r\n            Validators.required,\r\n            Validators.maxLength(200)\r\n          ])\r\n        })\r\n      ])\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.populateFieldOptionsForm();\r\n  }\r\n\r\n  getOptionsFormArray(): FormArray {\r\n    return this.fieldOptionsForm.get('options') as FormArray;\r\n  }\r\n\r\n  private populateFieldOptionsForm() {\r\n    const optionsArray = this.getOptionsFormArray();\r\n    optionsArray.clear();\r\n\r\n    for (let i = 0; i < this.fieldOptions.length; i++) {\r\n      let value = this.fieldOptions[i].text;\r\n\r\n      optionsArray.push(\r\n        new FormGroup({\r\n          text: new FormControl<string>(value, [\r\n            Validators.required,\r\n            Validators.maxLength(200)\r\n          ])\r\n        })\r\n      );\r\n    }\r\n  }\r\n\r\n  addFieldOption() {\r\n    const optionsArray = this.getOptionsFormArray();\r\n    optionsArray.push(\r\n      new FormGroup({\r\n        text: new FormControl<string>('', [\r\n          Validators.required,\r\n          Validators.maxLength(200)\r\n        ])\r\n      })\r\n    );\r\n\r\n    this.fieldOptions.push(new FieldOption(null, ''));\r\n\r\n    this.fieldOptionsChange.emit(this.fieldOptions);\r\n  }\r\n\r\n  removeFieldOption(indexToRemove: number) {\r\n    const optionsArray = this.getOptionsFormArray();\r\n    optionsArray.removeAt(indexToRemove);\r\n\r\n    this.fieldOptions = this.fieldOptions.filter((_, index) => index != indexToRemove);\r\n\r\n    this.fieldOptionsChange.emit(this.fieldOptions);\r\n  }\r\n\r\n  updateTextInFieldOptions() {\r\n    const optionsArray = this.getOptionsFormArray();\r\n\r\n    for (let i = 0; i < this.fieldOptions.length; i++) {\r\n      let text = optionsArray.controls[i].getRawValue().text;\r\n\r\n      this.fieldOptions[i].text = text;\r\n      this.fieldOptions[i].shownName = text;\r\n    }\r\n\r\n    this.fieldOptionsChange.emit(this.fieldOptions);\r\n  }\r\n}\r\n","<div *ngIf=\"visible\">\r\n  <br/>\r\n  <p class=\"mt-0 mb-0\">\r\n    <app-field-name\r\n      fieldName=\"Варианты ответа\"\r\n      [required]=\"true\"\r\n    ></app-field-name>\r\n  </p>\r\n\r\n  <div class=\"options-container\">\r\n    <form [formGroup]=\"fieldOptionsForm\">\r\n      <div formArrayName=\"options\">\r\n        <div *ngFor=\"let child of fieldOptionsForm.get('options')['controls']; let i = index\"\r\n             formGroupName=\"{{i}}\"\r\n        >\r\n          <div class=\"row mt-1\">\r\n            <div class=\"col\">\r\n              <input type=\"text\" (change)=\"updateTextInFieldOptions()\" formControlName=\"text\"\r\n                     class=\"form-control\" placeholder=\"Вариант {{i + 1}}\">\r\n            </div>\r\n            <div class=\"col-auto\">\r\n              <button type=\"button\" class=\"btn btn-danger text-white text-xl fw-bolder\" (click)=\"removeFieldOption(i)\">✕</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n  <button type=\"button\" class=\"btn btn-dark mt-2 text-white text-xl fw-semibold\" (click)=\"addFieldOption()\">Добавить</button>\r\n</div>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}