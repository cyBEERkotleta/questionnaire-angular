{"ast":null,"code":"import { NavigationEnd } from \"@angular/router\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nexport class UrlService {\n  constructor(router) {\n    this.LAST_PAGE_KEY = 'last_page_route';\n    this.CURRENT_PAGE_KEY = 'current_page_route';\n    this.router = router;\n    this.subscribeToNavigationEvents();\n  }\n  subscribeToNavigationEvents() {\n    this.router.events.subscribe(event => {\n      if (event instanceof NavigationEnd) {\n        /*this.lastUrl = event.url;\n        console.log('Последний адрес:', this.lastUrl);*/\n        this.lastPage = this.getCurrentRouterLink();\n        console.log('Последний адрес: ' + this.lastPage);\n      }\n    });\n  }\n  saveCurrentPage() {\n    let currentPage = this.getCurrentRouterLink();\n    let prevPage = this.getCurrentPage();\n    if (prevPage != currentPage) {\n      sessionStorage.setItem(this.LAST_PAGE_KEY, prevPage);\n      sessionStorage.setItem(this.CURRENT_PAGE_KEY, currentPage);\n    }\n    console.log('prev page: ' + prevPage);\n    console.log('current page: ' + currentPage);\n    console.log('last page: ' + this.getLastPage());\n  }\n  getCurrentPage() {\n    return sessionStorage.getItem(this.CURRENT_PAGE_KEY);\n  }\n  getLastPage() {\n    return this.lastPage;\n    //return sessionStorage.getItem(this.LAST_PAGE_KEY);\n  }\n\n  getCurrentRouterLink() {\n    const urlTree = this.router.createUrlTree([], {\n      queryParamsHandling: 'merge',\n      preserveFragment: true\n    });\n    return this.router.serializeUrl(urlTree);\n  }\n}\nUrlService.ɵfac = function UrlService_Factory(t) {\n  return new (t || UrlService)(i0.ɵɵinject(i1.Router));\n};\nUrlService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: UrlService,\n  factory: UrlService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["NavigationEnd","UrlService","constructor","router","LAST_PAGE_KEY","CURRENT_PAGE_KEY","subscribeToNavigationEvents","events","subscribe","event","lastPage","getCurrentRouterLink","console","log","saveCurrentPage","currentPage","prevPage","getCurrentPage","sessionStorage","setItem","getLastPage","getItem","urlTree","createUrlTree","queryParamsHandling","preserveFragment","serializeUrl","i0","ɵɵinject","i1","Router","factory","ɵfac","providedIn"],"sources":["C:\\Важное\\6 семестр =)\\Практыка\\Проект\\questionnaire\\angular-questionnaire\\src\\app\\service\\url.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport {NavigationEnd, Router} from \"@angular/router\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UrlService {\n  private router: Router;\n\n  private LAST_PAGE_KEY = 'last_page_route';\n  private CURRENT_PAGE_KEY = 'current_page_route';\n\n  private lastPage: string;\n\n  constructor(router: Router) {\n    this.router = router;\n    this.subscribeToNavigationEvents();\n  }\n\n  private subscribeToNavigationEvents(): void {\n    this.router.events.subscribe(event => {\n      if (event instanceof NavigationEnd) {\n        /*this.lastUrl = event.url;\n        console.log('Последний адрес:', this.lastUrl);*/\n        this.lastPage = this.getCurrentRouterLink();\n        console.log('Последний адрес: ' + this.lastPage);\n      }\n    });\n  }\n\n  saveCurrentPage() {\n    let currentPage = this.getCurrentRouterLink();\n\n    let prevPage = this.getCurrentPage();\n    if (prevPage != currentPage) {\n      sessionStorage.setItem(this.LAST_PAGE_KEY, prevPage);\n      sessionStorage.setItem(this.CURRENT_PAGE_KEY, currentPage);\n    }\n\n    console.log('prev page: ' + prevPage);\n    console.log('current page: ' + currentPage);\n    console.log('last page: ' + this.getLastPage());\n  }\n\n  getCurrentPage() {\n    return sessionStorage.getItem(this.CURRENT_PAGE_KEY);\n  }\n\n  getLastPage() {\n    return this.lastPage;\n    //return sessionStorage.getItem(this.LAST_PAGE_KEY);\n  }\n\n  private getCurrentRouterLink(): string {\n    const urlTree = this.router.createUrlTree([], {\n      queryParamsHandling: 'merge',\n      preserveFragment: true\n    });\n\n    return this.router.serializeUrl(urlTree);\n  }\n}\n"],"mappings":"AACA,SAAQA,aAAa,QAAe,iBAAiB;;;AAKrD,OAAM,MAAOC,UAAU;EAQrBC,YAAYC,MAAc;IALlB,KAAAC,aAAa,GAAG,iBAAiB;IACjC,KAAAC,gBAAgB,GAAG,oBAAoB;IAK7C,IAAI,CAACF,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACG,2BAA2B,EAAE;EACpC;EAEQA,2BAA2BA,CAAA;IACjC,IAAI,CAACH,MAAM,CAACI,MAAM,CAACC,SAAS,CAACC,KAAK,IAAG;MACnC,IAAIA,KAAK,YAAYT,aAAa,EAAE;QAClC;;QAEA,IAAI,CAACU,QAAQ,GAAG,IAAI,CAACC,oBAAoB,EAAE;QAC3CC,OAAO,CAACC,GAAG,CAAC,mBAAmB,GAAG,IAAI,CAACH,QAAQ,CAAC;;IAEpD,CAAC,CAAC;EACJ;EAEAI,eAAeA,CAAA;IACb,IAAIC,WAAW,GAAG,IAAI,CAACJ,oBAAoB,EAAE;IAE7C,IAAIK,QAAQ,GAAG,IAAI,CAACC,cAAc,EAAE;IACpC,IAAID,QAAQ,IAAID,WAAW,EAAE;MAC3BG,cAAc,CAACC,OAAO,CAAC,IAAI,CAACf,aAAa,EAAEY,QAAQ,CAAC;MACpDE,cAAc,CAACC,OAAO,CAAC,IAAI,CAACd,gBAAgB,EAAEU,WAAW,CAAC;;IAG5DH,OAAO,CAACC,GAAG,CAAC,aAAa,GAAGG,QAAQ,CAAC;IACrCJ,OAAO,CAACC,GAAG,CAAC,gBAAgB,GAAGE,WAAW,CAAC;IAC3CH,OAAO,CAACC,GAAG,CAAC,aAAa,GAAG,IAAI,CAACO,WAAW,EAAE,CAAC;EACjD;EAEAH,cAAcA,CAAA;IACZ,OAAOC,cAAc,CAACG,OAAO,CAAC,IAAI,CAAChB,gBAAgB,CAAC;EACtD;EAEAe,WAAWA,CAAA;IACT,OAAO,IAAI,CAACV,QAAQ;IACpB;EACF;;EAEQC,oBAAoBA,CAAA;IAC1B,MAAMW,OAAO,GAAG,IAAI,CAACnB,MAAM,CAACoB,aAAa,CAAC,EAAE,EAAE;MAC5CC,mBAAmB,EAAE,OAAO;MAC5BC,gBAAgB,EAAE;KACnB,CAAC;IAEF,OAAO,IAAI,CAACtB,MAAM,CAACuB,YAAY,CAACJ,OAAO,CAAC;EAC1C;;AAtDWrB,UAAU,C;mBAAVA,UAAU,EAAA0B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,MAAA;AAAA;AAAV7B,UAAU,C;SAAVA,UAAU;EAAA8B,OAAA,EAAV9B,UAAU,CAAA+B,IAAA;EAAAC,UAAA,EAFT;AAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}