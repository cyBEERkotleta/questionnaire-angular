{"ast":null,"code":"import { catchError, throwError } from \"rxjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./error.service\";\nimport * as i3 from \"./session.service\";\nexport class FormService {\n  constructor(http, errorService, sessionService) {\n    this.http = http;\n    this.errorService = errorService;\n    this.sessionService = sessionService;\n  }\n  isFormPresent(form) {\n    return !!form && !!form.id && !!form.fields && !!form.name && !!form.answeredForms;\n  }\n  getAll() {\n    return this.http.get('http://localhost:8080/forms').pipe(catchError(this.errorHandler.bind(this)));\n  }\n  getFormsByTopicId(topicId) {\n    let path = 'http://localhost:8080/forms/topic_' + topicId;\n    return this.http.get(path).pipe(catchError(this.errorHandler.bind(this)));\n  }\n  getFormsByUserId(userId) {\n    let token = this.sessionService.getToken();\n    let path = 'http://localhost:8080/forms/user_' + userId;\n    return this.http.post(path, token).pipe(catchError(this.errorHandler.bind(this)));\n  }\n  getFormById(id) {\n    let token = this.sessionService.getToken();\n    let path = 'http://localhost:8080/forms/' + id;\n    return this.http.post(path, token).pipe(catchError(this.errorHandler.bind(this)));\n  }\n  saveForm(form) {\n    let token = this.sessionService.getToken();\n    let tokenWithForm = {\n      token: token,\n      form: form\n    };\n    return this.http.post('http://localhost:8080/save_form', tokenWithForm).pipe(catchError(this.errorHandler.bind(this)));\n  }\n  deleteForm(form) {\n    let token = this.sessionService.getToken();\n    let tokenWithForm = {\n      token: token,\n      form: form\n    };\n    return this.http.post('http://localhost:8080/delete_form', tokenWithForm).pipe(catchError(this.errorHandler.bind(this)));\n  }\n  errorHandler(error) {\n    this.errorService.handle(error.message);\n    return throwError(() => error.message);\n  }\n}\nFormService.ɵfac = function FormService_Factory(t) {\n  return new (t || FormService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.ErrorService), i0.ɵɵinject(i3.SessionService));\n};\nFormService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: FormService,\n  factory: FormService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["catchError","throwError","FormService","constructor","http","errorService","sessionService","isFormPresent","form","id","fields","name","answeredForms","getAll","get","pipe","errorHandler","bind","getFormsByTopicId","topicId","path","getFormsByUserId","userId","token","getToken","post","getFormById","saveForm","tokenWithForm","deleteForm","error","handle","message","i0","ɵɵinject","i1","HttpClient","i2","ErrorService","i3","SessionService","factory","ɵfac","providedIn"],"sources":["C:\\Важное\\6 семестр =)\\Практыка\\Проект\\questionnaire\\angular-questionnaire\\src\\app\\service\\form.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport {HttpClient, HttpErrorResponse} from \"@angular/common/http\";\nimport {ErrorService} from \"./error.service\";\nimport {catchError, Observable, throwError} from \"rxjs\";\nimport {RequestResult} from \"../additional/RequestResult\";\nimport {Form} from \"../entity/Form\";\nimport {SessionService} from \"./session.service\";\nimport {Field} from \"../entity/Field\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FormService {\n  private http: HttpClient;\n  private errorService: ErrorService;\n  private sessionService: SessionService;\n\n  constructor(http: HttpClient,\n              errorService: ErrorService,\n              sessionService: SessionService) {\n    this.http = http;\n    this.errorService = errorService;\n    this.sessionService = sessionService;\n  }\n\n  isFormPresent(form: Form): boolean {\n    return !!form && !!form.id && !!form.fields && !!form.name && !!form.answeredForms;\n  }\n\n  getAll(): Observable<Form[]> {\n    return this.http.get<Form[]>('http://localhost:8080/forms')\n      .pipe(\n        catchError(this.errorHandler.bind(this))\n      );\n  }\n\n  getFormsByTopicId(topicId: bigint) : Observable<Form[]> {\n    let path = 'http://localhost:8080/forms/topic_' + topicId;\n    return this.http.get<Form[]>(path)\n      .pipe(\n        catchError(this.errorHandler.bind(this)),\n      );\n  }\n\n  getFormsByUserId(userId: bigint) : Observable<Form[]> {\n    let token = this.sessionService.getToken();\n    let path = 'http://localhost:8080/forms/user_' + userId;\n    return this.http.post<Form[]>(path, token)\n      .pipe(\n        catchError(this.errorHandler.bind(this)),\n      );\n  }\n\n  getFormById(id: bigint): Observable<Form> {\n    let token = this.sessionService.getToken();\n    let path = 'http://localhost:8080/forms/' + id;\n    return this.http.post<Form>(path, token)\n      .pipe(\n        catchError(this.errorHandler.bind(this)),\n      );\n  }\n\n  saveForm(form: Form): Observable<RequestResult> {\n    let token = this.sessionService.getToken();\n    let tokenWithForm = {token: token, form: form};\n    return this.http.post<RequestResult>('http://localhost:8080/save_form', tokenWithForm)\n      .pipe(\n        catchError(this.errorHandler.bind(this)),\n      );\n  }\n\n  deleteForm(form: Form): Observable<RequestResult> {\n    let token = this.sessionService.getToken();\n    let tokenWithForm = {token: token, form: form};\n    return this.http.post<RequestResult>('http://localhost:8080/delete_form', tokenWithForm)\n      .pipe(\n        catchError(this.errorHandler.bind(this)),\n      );\n  }\n\n  private errorHandler(error: HttpErrorResponse) {\n    this.errorService.handle(error.message);\n    return throwError(() => error.message);\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}